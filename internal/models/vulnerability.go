package models

import (
	"fmt"
	"time"
)

const (
	TypePlugin = "Plugin"
	TypeTheme  = "Theme"
)

const textFormat = `
%c <b>%s</b>

⚡️ <b>Severity:</b> %s

📌 <b>Type:</b> %s
🌐 <b>Version:</b> %s
📃 <b>Description:</b> %s
📅 <b>Published:</b> %s

<a href="%s">Detailed Information ... </a>
`

type Vulnerability struct {
	Slug        string
	Type        string
	Name        string
	Version     string
	Description string
	Severity    string
	Link        string
	Date        time.Time
}

func (v Vulnerability) String() string {
	var typeEmoji rune
	switch v.Type {
	case TypePlugin:
		typeEmoji = '🧩'
	case TypeTheme:
		typeEmoji = '🎨'
	default:
		typeEmoji = '🦠'
	}

	return fmt.Sprintf(textFormat, typeEmoji, v.Name, v.Severity, v.Type, v.Version, v.Description, v.Date.Format("Jan 2, 2006"), v.Link)
}
